!function(t){function a(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}var e={};a.m=t,a.c=e,a.i=function(t){return t},a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},a.p="",a(a.s=1)}([function(t,a,e){"use strict";function i(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,a){for(var e=0;e<a.length;e++){var i=a[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(a,e,i){return e&&t(a.prototype,e),i&&t(a,i),a}}(),h=jQuery,n=function(){function t(){var a=this;i(this,t),this.horizontalWorker=new Worker("worker.js"),this.verticalWorker=new Worker("worker.js"),this.canvas1=h("#canvas1")[0],this.canvas2=h("#canvas2")[0],this.canvas3=h("#canvas3")[0],this.canvas4=h("#canvas4")[0],this.canvas5=h("#canvas5")[0],this.ctx1=this.canvas1.getContext("2d"),this.ctx2=this.canvas2.getContext("2d"),this.ctx3=this.canvas3.getContext("2d"),this.ctx4=this.canvas4.getContext("2d"),this.ctx5=this.canvas5.getContext("2d"),this.mousePosition={x:0,y:100},this.img=new Image,this.img.src="Picture1.jpg",this.img.onload=function(t){return a.imageLoaded(t)}}return s(t,[{key:"imageLoaded",value:function(t){var a=this.img.width,e=this.img.height;this.canvas1.width=a,this.canvas1.height=e,this.canvas2.width=a,this.canvas2.height=e,this.canvas3.width=a,this.canvas3.height=e,this.canvas4.width=a,this.canvas4.height=e,this.canvas5.width=a,this.canvas5.height=e,this.ctx1.drawImage(this.img,0,0),this.ctx2.strokeText("Running Vertical",this.canvas1.width/2,this.canvas1.height/2),this.ctx2.strokeText("Sobel Edge Detection",this.canvas1.width/2,this.canvas1.height/2+15),this.ctx3.strokeText("Running Horizontal",this.canvas1.width/2,this.canvas1.height/2),this.ctx3.strokeText("Sobel Edge Detection",this.canvas1.width/2,this.canvas1.height/2+15),this.ctx4.strokeText("Combined",this.canvas1.width/2,this.canvas1.height/2),this.ctx4.strokeText("Sobel Edge Detection",this.canvas1.width/2,this.canvas1.height/2+15),this.ctx5.strokeText("Threshold >= 100",this.canvas1.width/2,this.canvas1.height/2),this.ctx5.strokeText("Sobel Edge Detection",this.canvas1.width/2,this.canvas1.height/2+15),this.imageData=this.ctx1.getImageData(0,0,this.canvas1.width,this.canvas1.height),this.startWorkers(),this.bindEvents(),this.drawIntensityProfile()}},{key:"onMessage",value:function(t){switch(t.data.action){case"SEND_EDGE_IMAGE_DATA":if("vertical"===t.data.type?(this.ctx2.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx2.putImageData(t.data.data,0,0),this.hasVerticalData=!0,this.verticalData=t.data.squared):(this.ctx3.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx3.putImageData(t.data.data,0,0),this.hasHorizontalData=!0,this.horizontalData=t.data.squared),this.hasHorizontalData&&this.hasVerticalData){for(var a=math.add(this.horizontalData,this.verticalData),e=math.matrix(math.sqrt(a)),i=[],s=0;s<e._data.length;s++)for(var h=0;h<e._data[s].length;h++){e._data[s][h][3]=255;var n=e._data[s][h].slice();n[0]>=50&&(n[0]=255,n[1]=255,n[2]=255),i.push(n)}var r=Uint8ClampedArray.from(math.flatten(e._data)),c=new ImageData(r,e._data[0].length,e._data.length);this.ctx4.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx4.putImageData(c,0,0);var o=Uint8ClampedArray.from(math.flatten(i)),v=new ImageData(o,e._data[0].length,e._data.length);this.ctx5.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx5.putImageData(v,0,0)}break;case"WORKER_STARTED":"vertical"===t.data.type?this.verticalWorker.postMessage({action:"DETECT",imageData:this.imageData,height:this.canvas1.height,width:this.canvas1.width}):this.horizontalWorker.postMessage({action:"DETECT",imageData:this.imageData,height:this.canvas1.height,width:this.canvas1.width})}}},{key:"startWorkers",value:function(){var t=this;this.horizontalWorker.postMessage({action:"START_WORKER",type:"horizontal"}),this.verticalWorker.postMessage({action:"START_WORKER",type:"vertical"}),this.horizontalWorker.onmessage=function(a){return t.onMessage(a)},this.verticalWorker.onmessage=function(a){return t.onMessage(a)}}},{key:"redrawImage",value:function(){this.ctx1.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx1.drawImage(this.img,0,0),this.ctx1.beginPath(),this.ctx1.moveTo(0,this.mousePosition.y),this.ctx1.lineTo(this.canvas1.width,this.mousePosition.y),this.ctx1.strokeStyle="green",this.ctx1.stroke()}},{key:"bindEvents",value:function(){var t=this;h("#canvas1").on("mousemove",function(a){return t.mouseMoved(a)})}},{key:"mouseMoved",value:function(t){this.mousePosition=this.getMousePos(this.canvas1,t),this.drawIntensityProfile()}},{key:"drawIntensityProfile",value:function(){var t=this.ctx1.getImageData(0,this.mousePosition.y,this.canvas1.width,1),a=math.matrix(math.reshape(Array.from(t.data),[1,t.width,4]));a=math.subset(a,math.index(0,math.range(0,a.size()[1]),math.range(0,3)));var e=[],i=!0,s=!1,h=void 0;try{for(var n,r=a._data[0][Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var c=n.value;e.push(math.sum(c)/3)}}catch(t){s=!0,h=t}finally{try{!i&&r.return&&r.return()}finally{if(s)throw h}}if(void 0===this.chart)this.chart=new Highcharts.Chart({chart:{renderTo:"hc_container1"},title:{text:"Row Intensity Profile"},yAxis:{plotLines:[{value:0,width:1,color:"#808080"}]},legend:{enabled:!1},series:{id:"the-measurement",name:"Measurement",data:e,lineWidth:1,marker:{enabled:!1}}});else{var o=this.chart.get("the-measurement");o&&o.remove(),this.chart.addSeries({id:"the-measurement",name:"Measurement",data:e,lineWidth:1,marker:{enabled:!1}})}this.redrawImage()}},{key:"getMousePos",value:function(t,a){var e=t.getBoundingClientRect();return{x:a.clientX-e.left,y:a.clientY-e.top}}}]),t}();h(function(){return new n})},function(t,a,e){t.exports=e(0)}]);
//# sourceMappingURL=edge.js.map