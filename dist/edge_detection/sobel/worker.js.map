{"version":3,"sources":["webpack:///dist/edge_detection/sobel/worker.js","webpack:///webpack/bootstrap ec900026ce65799c77b4","webpack:///./src/edge_detection/sobel/Worker.es6"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","importScripts","Worker","type","this","console","log","horizontalFilter","math","matrix","verticalFilter","imageData","canvasHeight","canvasWidth","ym3","xm3","rows","squaredRows","Array","from","data","y","rowSize","begin","end","row1","slice","row2","row3","M","reshape","push","x","subset","index","range","dotMultiply","sum","squared","Math","pow","Uint8ClampedArray","flatten","id","ImageData","postMessage","action","worker","onmessage","e","process","height","width"],"mappings":"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","file":"./dist/edge_detection/sobel/worker.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimportScripts('../../scripts/math.js');\n\nvar Worker = function () {\n    function Worker(type) {\n        _classCallCheck(this, Worker);\n\n        console.log(\"Worker.constructor\");\n        console.log(type);\n        this.type = type;\n        /**\n         *\n         * @type {DenseMatrix}\n         */\n        this.horizontalFilter = math.matrix([[1, 0, -1], [2, 0, -2], [1, 0, -1]]);\n        /**\n         *\n         * @type {DenseMatrix}\n         */\n        this.verticalFilter = math.matrix([[1, 2, 1], [0, 0, 0], [-1, -2, -1]]);\n    }\n\n    _createClass(Worker, [{\n        key: \"process\",\n        value: function process(imageData, canvasHeight, canvasWidth) {\n            var ym3 = canvasHeight - 3;\n            var xm3 = canvasWidth - 3;\n            var rows = [];\n            var squaredRows = [];\n\n            imageData = Array.from(imageData.data);\n            for (var y = 0; y < canvasHeight; y++) {\n                var rowSize = 4 * canvasWidth;\n                var begin = y * rowSize;\n                var end = begin + rowSize;\n                var row1 = imageData.slice(begin, end);\n                var row2 = imageData.slice(begin + rowSize, end + rowSize);\n                var row3 = imageData.slice(begin + rowSize + rowSize, end + rowSize + rowSize);\n                /**\n                 * @type {DenseMatrix}\n                 */\n                var M = math.matrix([row1, row2, row3]);\n                M = math.reshape(M, [3, canvasWidth, 4]);\n                rows.push([]);\n                squaredRows.push([]);\n                for (var x = 0; x < canvasWidth; x++) {\n                    /**\n                     * @type {DenseMatrix}\n                     */\n                    var m = math.subset(M, math.index(math.range(0, 3), math.range(x, x + 3), 0));\n                    m = math.reshape(m, [3, 3]);\n                    if (this.type === \"horizontal\") {\n                        m = math.dotMultiply(m, this.horizontalFilter);\n                    } else {\n                        m = math.dotMultiply(m, this.verticalFilter);\n                    }\n                    m = math.sum(m);\n                    rows[y].push([m, m, m, 255]);\n                    var squared = Math.pow(m, 2);\n                    squaredRows[y].push([squared, squared, squared, 255]);\n                    if (x === xm3) {\n                        break;\n                    }\n                }\n                if (y === ym3) {\n                    break;\n                }\n            }\n            var data = Uint8ClampedArray.from(math.flatten(rows));\n            var id = new ImageData(data, rows[0].length, rows.length);\n            postMessage({\n                action: 'SEND_EDGE_IMAGE_DATA',\n                data: id,\n                type: this.type,\n                squared: squaredRows\n            });\n        }\n    }]);\n\n    return Worker;\n}();\n\nvar worker = null;\n\nonmessage = function onmessage(e) {\n\n    switch (e.data.action) {\n        case 'START_WORKER':\n            console.log(\"start worker\");\n            worker = new Worker(e.data.type);\n            postMessage({\n                action: 'WORKER_STARTED',\n                type: e.data.type\n            });\n            break;\n\n        case 'DETECT':\n            worker.process(e.data.imageData, e.data.height, e.data.width);\n            break;\n    }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyY1xcZWRnZV9kZXRlY3Rpb25cXHNvYmVsXFxXb3JrZXIuZXM2Il0sIm5hbWVzIjpbImltcG9ydFNjcmlwdHMiLCJXb3JrZXIiLCJ0eXBlIiwiY29uc29sZSIsImxvZyIsImhvcml6b250YWxGaWx0ZXIiLCJtYXRoIiwibWF0cml4IiwidmVydGljYWxGaWx0ZXIiLCJpbWFnZURhdGEiLCJjYW52YXNIZWlnaHQiLCJjYW52YXNXaWR0aCIsInltMyIsInhtMyIsInJvd3MiLCJzcXVhcmVkUm93cyIsIkFycmF5IiwiZnJvbSIsImRhdGEiLCJ5Iiwicm93U2l6ZSIsImJlZ2luIiwiZW5kIiwicm93MSIsInNsaWNlIiwicm93MiIsInJvdzMiLCJNIiwicmVzaGFwZSIsInB1c2giLCJ4IiwibSIsInN1YnNldCIsImluZGV4IiwicmFuZ2UiLCJkb3RNdWx0aXBseSIsInN1bSIsInNxdWFyZWQiLCJNYXRoIiwicG93IiwiVWludDhDbGFtcGVkQXJyYXkiLCJmbGF0dGVuIiwiaWQiLCJJbWFnZURhdGEiLCJsZW5ndGgiLCJwb3N0TWVzc2FnZSIsImFjdGlvbiIsIndvcmtlciIsIm9ubWVzc2FnZSIsImUiLCJwcm9jZXNzIiwiaGVpZ2h0Iiwid2lkdGgiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBQSxjQUFjLHVCQUFkOztJQUVNQyxNO0FBRUYsb0JBQVlDLElBQVosRUFBa0I7QUFBQTs7QUFDZEMsZ0JBQVFDLEdBQVIsQ0FBWSxvQkFBWjtBQUNBRCxnQkFBUUMsR0FBUixDQUFZRixJQUFaO0FBQ0EsYUFBS0EsSUFBTCxHQUFZQSxJQUFaO0FBQ0E7Ozs7QUFJQSxhQUFLRyxnQkFBTCxHQUF3QkMsS0FBS0MsTUFBTCxDQUFZLENBQ2hDLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFDLENBQVIsQ0FEZ0MsRUFFaEMsQ0FBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQUMsQ0FBUixDQUZnQyxFQUdoQyxDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBQyxDQUFSLENBSGdDLENBQVosQ0FBeEI7QUFLQTs7OztBQUlBLGFBQUtDLGNBQUwsR0FBc0JGLEtBQUtDLE1BQUwsQ0FBWSxDQUM5QixDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxDQUQ4QixFQUU5QixDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxDQUY4QixFQUc5QixDQUFDLENBQUMsQ0FBRixFQUFLLENBQUMsQ0FBTixFQUFTLENBQUMsQ0FBVixDQUg4QixDQUFaLENBQXRCO0FBS0g7Ozs7Z0NBRU9FLFMsRUFBV0MsWSxFQUFjQyxXLEVBQWE7QUFDMUMsZ0JBQUlDLE1BQU1GLGVBQWUsQ0FBekI7QUFDQSxnQkFBSUcsTUFBTUYsY0FBYyxDQUF4QjtBQUNBLGdCQUFJRyxPQUFPLEVBQVg7QUFDQSxnQkFBSUMsY0FBYyxFQUFsQjs7QUFFQU4sd0JBQVlPLE1BQU1DLElBQU4sQ0FBV1IsVUFBVVMsSUFBckIsQ0FBWjtBQUNBLGlCQUFJLElBQUlDLElBQUksQ0FBWixFQUFlQSxJQUFJVCxZQUFuQixFQUFpQ1MsR0FBakMsRUFBc0M7QUFDbEMsb0JBQUlDLFVBQVUsSUFBSVQsV0FBbEI7QUFDQSxvQkFBSVUsUUFBUUYsSUFBSUMsT0FBaEI7QUFDQSxvQkFBSUUsTUFBTUQsUUFBUUQsT0FBbEI7QUFDQSxvQkFBSUcsT0FBT2QsVUFBVWUsS0FBVixDQUFnQkgsS0FBaEIsRUFBdUJDLEdBQXZCLENBQVg7QUFDQSxvQkFBSUcsT0FBT2hCLFVBQVVlLEtBQVYsQ0FBZ0JILFFBQVFELE9BQXhCLEVBQWlDRSxNQUFNRixPQUF2QyxDQUFYO0FBQ0Esb0JBQUlNLE9BQU9qQixVQUFVZSxLQUFWLENBQWdCSCxRQUFRRCxPQUFSLEdBQWtCQSxPQUFsQyxFQUEyQ0UsTUFBTUYsT0FBTixHQUFnQkEsT0FBM0QsQ0FBWDtBQUNBOzs7QUFHQSxvQkFBSU8sSUFBSXJCLEtBQUtDLE1BQUwsQ0FBWSxDQUFDZ0IsSUFBRCxFQUFPRSxJQUFQLEVBQWFDLElBQWIsQ0FBWixDQUFSO0FBQ0FDLG9CQUFJckIsS0FBS3NCLE9BQUwsQ0FBYUQsQ0FBYixFQUFnQixDQUFDLENBQUQsRUFBSWhCLFdBQUosRUFBaUIsQ0FBakIsQ0FBaEIsQ0FBSjtBQUNBRyxxQkFBS2UsSUFBTCxDQUFVLEVBQVY7QUFDQWQsNEJBQVljLElBQVosQ0FBaUIsRUFBakI7QUFDQSxxQkFBSSxJQUFJQyxJQUFJLENBQVosRUFBZUEsSUFBSW5CLFdBQW5CLEVBQWdDbUIsR0FBaEMsRUFBcUM7QUFDakM7OztBQUdBLHdCQUFJQyxJQUFJekIsS0FBSzBCLE1BQUwsQ0FDSkwsQ0FESSxFQUVKckIsS0FBSzJCLEtBQUwsQ0FDSTNCLEtBQUs0QixLQUFMLENBQVcsQ0FBWCxFQUFjLENBQWQsQ0FESixFQUVJNUIsS0FBSzRCLEtBQUwsQ0FBV0osQ0FBWCxFQUFjQSxJQUFJLENBQWxCLENBRkosRUFHSSxDQUhKLENBRkksQ0FBUjtBQVFBQyx3QkFBSXpCLEtBQUtzQixPQUFMLENBQWFHLENBQWIsRUFBZ0IsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUFoQixDQUFKO0FBQ0Esd0JBQUcsS0FBSzdCLElBQUwsS0FBYyxZQUFqQixFQUErQjtBQUMzQjZCLDRCQUFJekIsS0FBSzZCLFdBQUwsQ0FBaUJKLENBQWpCLEVBQW9CLEtBQUsxQixnQkFBekIsQ0FBSjtBQUNILHFCQUZELE1BRU87QUFDSDBCLDRCQUFJekIsS0FBSzZCLFdBQUwsQ0FBaUJKLENBQWpCLEVBQW9CLEtBQUt2QixjQUF6QixDQUFKO0FBQ0g7QUFDRHVCLHdCQUFJekIsS0FBSzhCLEdBQUwsQ0FBU0wsQ0FBVCxDQUFKO0FBQ0FqQix5QkFBS0ssQ0FBTCxFQUFRVSxJQUFSLENBQWEsQ0FBQ0UsQ0FBRCxFQUFJQSxDQUFKLEVBQU9BLENBQVAsRUFBVSxHQUFWLENBQWI7QUFDQSx3QkFBSU0sVUFBVUMsS0FBS0MsR0FBTCxDQUFTUixDQUFULEVBQVksQ0FBWixDQUFkO0FBQ0FoQixnQ0FBWUksQ0FBWixFQUFlVSxJQUFmLENBQW9CLENBQUNRLE9BQUQsRUFBVUEsT0FBVixFQUFtQkEsT0FBbkIsRUFBNEIsR0FBNUIsQ0FBcEI7QUFDQSx3QkFBR1AsTUFBTWpCLEdBQVQsRUFBYztBQUNWO0FBQ0g7QUFDSjtBQUNELG9CQUFHTSxNQUFNUCxHQUFULEVBQWM7QUFDVjtBQUNIO0FBQ0o7QUFDRCxnQkFBSU0sT0FBT3NCLGtCQUFrQnZCLElBQWxCLENBQXVCWCxLQUFLbUMsT0FBTCxDQUFhM0IsSUFBYixDQUF2QixDQUFYO0FBQ0EsZ0JBQUk0QixLQUFLLElBQUlDLFNBQUosQ0FBY3pCLElBQWQsRUFBb0JKLEtBQUssQ0FBTCxFQUFROEIsTUFBNUIsRUFBb0M5QixLQUFLOEIsTUFBekMsQ0FBVDtBQUNBQyx3QkFBWTtBQUNSQyx3QkFBUSxzQkFEQTtBQUVSNUIsc0JBQU13QixFQUZFO0FBR1J4QyxzQkFBTSxLQUFLQSxJQUhIO0FBSVJtQyx5QkFBU3RCO0FBSkQsYUFBWjtBQU1IOzs7Ozs7QUFHTCxJQUFJZ0MsU0FBUyxJQUFiOztBQUVBQyxZQUFZLG1CQUFTQyxDQUFULEVBQVk7O0FBRXBCLFlBQU9BLEVBQUUvQixJQUFGLENBQU80QixNQUFkO0FBQ0ksYUFBSyxjQUFMO0FBQ0kzQyxvQkFBUUMsR0FBUixDQUFZLGNBQVo7QUFDQTJDLHFCQUFTLElBQUk5QyxNQUFKLENBQVdnRCxFQUFFL0IsSUFBRixDQUFPaEIsSUFBbEIsQ0FBVDtBQUNBMkMsd0JBQVk7QUFDUkMsd0JBQVEsZ0JBREE7QUFFUjVDLHNCQUFNK0MsRUFBRS9CLElBQUYsQ0FBT2hCO0FBRkwsYUFBWjtBQUlBOztBQUVKLGFBQUssUUFBTDtBQUNJNkMsbUJBQU9HLE9BQVAsQ0FBZUQsRUFBRS9CLElBQUYsQ0FBT1QsU0FBdEIsRUFBaUN3QyxFQUFFL0IsSUFBRixDQUFPaUMsTUFBeEMsRUFBZ0RGLEVBQUUvQixJQUFGLENBQU9rQyxLQUF2RDtBQUNBO0FBWlI7QUFjSCxDQWhCRCIsImZpbGUiOiJXb3JrZXIuZXM2Iiwic291cmNlUm9vdCI6IkM6L1VzZXJzL3JpY2gvUGhwc3Rvcm1Qcm9qZWN0cy9qc2FsZ29zIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0U2NyaXB0cygnLi4vLi4vc2NyaXB0cy9tYXRoLmpzJyk7XG5cbmNsYXNzIFdvcmtlciB7XG5cbiAgICBjb25zdHJ1Y3Rvcih0eXBlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2VyLmNvbnN0cnVjdG9yXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyh0eXBlKTtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtEZW5zZU1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbEZpbHRlciA9IG1hdGgubWF0cml4KFtcbiAgICAgICAgICAgIFsxLCAwLCAtMV0sXG4gICAgICAgICAgICBbMiwgMCwgLTJdLFxuICAgICAgICAgICAgWzEsIDAsIC0xXVxuICAgICAgICBdKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtEZW5zZU1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmVydGljYWxGaWx0ZXIgPSBtYXRoLm1hdHJpeChbXG4gICAgICAgICAgICBbMSwgMiwgMV0sXG4gICAgICAgICAgICBbMCwgMCwgMF0sXG4gICAgICAgICAgICBbLTEsIC0yLCAtMV1cbiAgICAgICAgXSk7XG4gICAgfVxuXG4gICAgcHJvY2VzcyhpbWFnZURhdGEsIGNhbnZhc0hlaWdodCwgY2FudmFzV2lkdGgpIHtcbiAgICAgICAgbGV0IHltMyA9IGNhbnZhc0hlaWdodCAtIDM7XG4gICAgICAgIGxldCB4bTMgPSBjYW52YXNXaWR0aCAtIDM7XG4gICAgICAgIGxldCByb3dzID0gW107XG4gICAgICAgIGxldCBzcXVhcmVkUm93cyA9IFtdO1xuXG4gICAgICAgIGltYWdlRGF0YSA9IEFycmF5LmZyb20oaW1hZ2VEYXRhLmRhdGEpO1xuICAgICAgICBmb3IobGV0IHkgPSAwOyB5IDwgY2FudmFzSGVpZ2h0OyB5KyspIHtcbiAgICAgICAgICAgIGxldCByb3dTaXplID0gNCAqIGNhbnZhc1dpZHRoO1xuICAgICAgICAgICAgbGV0IGJlZ2luID0geSAqIHJvd1NpemU7XG4gICAgICAgICAgICBsZXQgZW5kID0gYmVnaW4gKyByb3dTaXplO1xuICAgICAgICAgICAgbGV0IHJvdzEgPSBpbWFnZURhdGEuc2xpY2UoYmVnaW4sIGVuZCk7XG4gICAgICAgICAgICBsZXQgcm93MiA9IGltYWdlRGF0YS5zbGljZShiZWdpbiArIHJvd1NpemUsIGVuZCArIHJvd1NpemUpO1xuICAgICAgICAgICAgbGV0IHJvdzMgPSBpbWFnZURhdGEuc2xpY2UoYmVnaW4gKyByb3dTaXplICsgcm93U2l6ZSwgZW5kICsgcm93U2l6ZSArIHJvd1NpemUpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAdHlwZSB7RGVuc2VNYXRyaXh9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxldCBNID0gbWF0aC5tYXRyaXgoW3JvdzEsIHJvdzIsIHJvdzNdKTtcbiAgICAgICAgICAgIE0gPSBtYXRoLnJlc2hhcGUoTSwgWzMsIGNhbnZhc1dpZHRoLCA0XSk7XG4gICAgICAgICAgICByb3dzLnB1c2goW10pO1xuICAgICAgICAgICAgc3F1YXJlZFJvd3MucHVzaChbXSk7XG4gICAgICAgICAgICBmb3IobGV0IHggPSAwOyB4IDwgY2FudmFzV2lkdGg7IHgrKykge1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIEB0eXBlIHtEZW5zZU1hdHJpeH1cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBsZXQgbSA9IG1hdGguc3Vic2V0KFxuICAgICAgICAgICAgICAgICAgICBNLFxuICAgICAgICAgICAgICAgICAgICBtYXRoLmluZGV4KFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5yYW5nZSgwLCAzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGgucmFuZ2UoeCwgeCArIDMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBtID0gbWF0aC5yZXNoYXBlKG0sIFszLCAzXSk7XG4gICAgICAgICAgICAgICAgaWYodGhpcy50eXBlID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICAgICAgICAgICAgICBtID0gbWF0aC5kb3RNdWx0aXBseShtLCB0aGlzLmhvcml6b250YWxGaWx0ZXIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG0gPSBtYXRoLmRvdE11bHRpcGx5KG0sIHRoaXMudmVydGljYWxGaWx0ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtID0gbWF0aC5zdW0obSk7XG4gICAgICAgICAgICAgICAgcm93c1t5XS5wdXNoKFttLCBtLCBtLCAyNTVdKTtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXJlZCA9IE1hdGgucG93KG0sIDIpO1xuICAgICAgICAgICAgICAgIHNxdWFyZWRSb3dzW3ldLnB1c2goW3NxdWFyZWQsIHNxdWFyZWQsIHNxdWFyZWQsIDI1NV0pO1xuICAgICAgICAgICAgICAgIGlmKHggPT09IHhtMykge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih5ID09PSB5bTMpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgZGF0YSA9IFVpbnQ4Q2xhbXBlZEFycmF5LmZyb20obWF0aC5mbGF0dGVuKHJvd3MpKTtcbiAgICAgICAgbGV0IGlkID0gbmV3IEltYWdlRGF0YShkYXRhLCByb3dzWzBdLmxlbmd0aCwgcm93cy5sZW5ndGgpO1xuICAgICAgICBwb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBhY3Rpb246ICdTRU5EX0VER0VfSU1BR0VfREFUQScsXG4gICAgICAgICAgICBkYXRhOiBpZCxcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICAgICAgICAgIHNxdWFyZWQ6IHNxdWFyZWRSb3dzXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxubGV0IHdvcmtlciA9IG51bGw7XG5cbm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcblxuICAgIHN3aXRjaChlLmRhdGEuYWN0aW9uKXtcbiAgICAgICAgY2FzZSAnU1RBUlRfV09SS0VSJzpcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3RhcnQgd29ya2VyXCIpO1xuICAgICAgICAgICAgd29ya2VyID0gbmV3IFdvcmtlcihlLmRhdGEudHlwZSk7XG4gICAgICAgICAgICBwb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnV09SS0VSX1NUQVJURUQnLFxuICAgICAgICAgICAgICAgIHR5cGU6IGUuZGF0YS50eXBlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ0RFVEVDVCc6XG4gICAgICAgICAgICB3b3JrZXIucHJvY2VzcyhlLmRhdGEuaW1hZ2VEYXRhLCBlLmRhdGEuaGVpZ2h0LCBlLmRhdGEud2lkdGgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufTsiXX0=\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(0);\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// dist/edge_detection/sobel/worker.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ec900026ce65799c77b4","importScripts('../../scripts/math.js');\n\nclass Worker {\n\n    constructor(type) {\n        console.log(\"Worker.constructor\");\n        console.log(type);\n        this.type = type;\n        /**\n         *\n         * @type {DenseMatrix}\n         */\n        this.horizontalFilter = math.matrix([\n            [1, 0, -1],\n            [2, 0, -2],\n            [1, 0, -1]\n        ]);\n        /**\n         *\n         * @type {DenseMatrix}\n         */\n        this.verticalFilter = math.matrix([\n            [1, 2, 1],\n            [0, 0, 0],\n            [-1, -2, -1]\n        ]);\n    }\n\n    process(imageData, canvasHeight, canvasWidth) {\n        let ym3 = canvasHeight - 3;\n        let xm3 = canvasWidth - 3;\n        let rows = [];\n        let squaredRows = [];\n\n        imageData = Array.from(imageData.data);\n        for(let y = 0; y < canvasHeight; y++) {\n            let rowSize = 4 * canvasWidth;\n            let begin = y * rowSize;\n            let end = begin + rowSize;\n            let row1 = imageData.slice(begin, end);\n            let row2 = imageData.slice(begin + rowSize, end + rowSize);\n            let row3 = imageData.slice(begin + rowSize + rowSize, end + rowSize + rowSize);\n            /**\n             * @type {DenseMatrix}\n             */\n            let M = math.matrix([row1, row2, row3]);\n            M = math.reshape(M, [3, canvasWidth, 4]);\n            rows.push([]);\n            squaredRows.push([]);\n            for(let x = 0; x < canvasWidth; x++) {\n                /**\n                 * @type {DenseMatrix}\n                 */\n                let m = math.subset(\n                    M,\n                    math.index(\n                        math.range(0, 3),\n                        math.range(x, x + 3),\n                        0\n                    )\n                );\n                m = math.reshape(m, [3, 3]);\n                if(this.type === \"horizontal\") {\n                    m = math.dotMultiply(m, this.horizontalFilter);\n                } else {\n                    m = math.dotMultiply(m, this.verticalFilter);\n                }\n                m = math.sum(m);\n                rows[y].push([m, m, m, 255]);\n                let squared = Math.pow(m, 2);\n                squaredRows[y].push([squared, squared, squared, 255]);\n                if(x === xm3) {\n                    break;\n                }\n            }\n            if(y === ym3) {\n                break;\n            }\n        }\n        let data = Uint8ClampedArray.from(math.flatten(rows));\n        let id = new ImageData(data, rows[0].length, rows.length);\n        postMessage({\n            action: 'SEND_EDGE_IMAGE_DATA',\n            data: id,\n            type: this.type,\n            squared: squaredRows\n        });\n    }\n}\n\nlet worker = null;\n\nonmessage = function(e) {\n\n    switch(e.data.action){\n        case 'START_WORKER':\n            console.log(\"start worker\");\n            worker = new Worker(e.data.type);\n            postMessage({\n                action: 'WORKER_STARTED',\n                type: e.data.type\n            });\n            break;\n\n        case 'DETECT':\n            worker.process(e.data.imageData, e.data.height, e.data.width);\n            break;\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/edge_detection/sobel/Worker.es6"],"sourceRoot":""}